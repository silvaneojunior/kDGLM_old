S=matrix(c(1,0.5,0,0.5,1,0,0,0,1),3,3)

T=matrix(c(1,0,0,0,1,0,-sqrt(1/6),-sqrt(1/6),0.5),3,3)

Q=t(T)%*%S%*%T
Q

Q[1:2,3:3]%*%solve(Q[3:3,3:3])%*%Q[3:3,1:2]
U=Q[1:2,1:2]-Q[1:2,3:3]%*%solve(Q[3:3,3:3])%*%Q[3:3,1:2]
U
V=U
V[1,]=V[1,]/sqrt(U[1,1])
V[,1]=V[,1]/sqrt(U[1,1])
V[2,]=V[2,]/sqrt(U[2,2])
V[,2]=V[,2]/sqrt(U[2,2])
V
